<div class="login d-flex justify-content-center align-items-center min-vh-100">
  <div class="login-screen p-4 rounded-4 shadow-lg">

    <div class="app-title mb-4 text-center">
      <h2>Cambio de contraseña</h2>
    </div>

    <!-- FORMULARIO DE LOGIN (validar usuario y contraseña actual) -->
    <form *ngIf="!bandera" (ngSubmit)="login()" class="login-form">

      <div class="form-floating mb-3">
        <input
          type="text"
          class="form-control"
          id="username"
          placeholder="Usuario"
          [(ngModel)]="username"
          name="username"
          required
          autocomplete="username"
        />
        <label for="username">Usuario</label>
      </div>

      <div class="form-floating mb-4 position-relative">
        <input
          [type]="showOldPassword ? 'text' : 'password'"
          class="form-control"
          id="password"
          placeholder="Contraseña actual"
          [(ngModel)]="password"
          name="password"
          required
          autocomplete="current-password"
        />
        <label for="password">Contraseña actual</label>

        <button
          type="button"
          class="btn btn-sm btn-outline-secondary position-absolute top-50 end-0 translate-middle-y me-2"
          (click)="showOldPassword = !showOldPassword"
          aria-label="Mostrar/ocultar contraseña actual"
        >
          <i class="bi" [ngClass]="showOldPassword ? 'bi-eye-slash' : 'bi-eye'"></i>
        </button>
      </div>

      <button class="btn btn-login w-100 mb-3" type="submit">Confirmar credenciales</button>
    </form>

    <!-- FORMULARIO CAMBIO DE CONTRASEÑA -->
    <form *ngIf="bandera" (ngSubmit)="cambiarPassword()" class="login-form">

      <div class="form-floating mb-3 position-relative">
        <input
          [type]="showNewPassword ? 'text' : 'password'"
          class="form-control"
          id="newpassword"
          placeholder="Nueva contraseña"
          [(ngModel)]="newpassword"
          name="newpassword"
          required
          autocomplete="new-password"
        />
        <label for="newpassword">Nueva contraseña</label>

        <button
          type="button"
          class="btn btn-sm btn-outline-secondary position-absolute top-50 end-0 translate-middle-y me-2"
          (click)="showNewPassword = !showNewPassword"
          aria-label="Mostrar/ocultar nueva contraseña"
        >
          <i class="bi" [ngClass]="showNewPassword ? 'bi-eye-slash' : 'bi-eye'"></i>
        </button>
      </div>

      <div class="form-floating mb-4 position-relative">
        <input
          [type]="showConfirmPassword ? 'text' : 'password'"
          class="form-control"
          id="confirmPassword"
          placeholder="Confirmar contraseña"
          [(ngModel)]="confirmPassword"
          name="confirmPassword"
          required
          autocomplete="new-password"
        />
        <label for="confirmPassword">Confirmar contraseña</label>

        <button
          type="button"
          class="btn btn-sm btn-outline-secondary position-absolute top-50 end-0 translate-middle-y me-2"
          (click)="showConfirmPassword = !showConfirmPassword"
          aria-label="Mostrar/ocultar confirmar contraseña"
        >
          <i class="bi" [ngClass]="showConfirmPassword ? 'bi-eye-slash' : 'bi-eye'"></i>
        </button>
      </div>

      <button class="btn btn-login w-100 mb-3 btn-success" type="submit">
        Cambiar contraseña
      </button>
    </form>

    <!-- Mensaje de error -->
    <div *ngIf="errorMessage" class="text-danger text-center mt-2">
      {{ errorMessage }}
    </div>
  </div>
</div>
